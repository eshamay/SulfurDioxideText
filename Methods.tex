\section{Computational Approach}

Molecular dynamics simulations were performed using the Amber 11 software suite.\cite{Case2010} Polarizable models for the \wat~and \suldiox~molecules were used in the simulations, and have been used previously in studies on interfacial systems because they are known to more accurately reproduce interfacial structure and free energy profiles.\cite{Wick2007,Rivera2006,Dang1998} The \wat~model used is the POL3 water model,\cite{Caldwell1995} and for \suldiox~we used the model of Baer et al. that places a single polarizable center on the sulfur atom.\cite{Baer2010}

All simulations began with an equilibrated cube of 900 \wat~molecules, with sides of length 30\angs. The long axis of each simulation cell (the axis normal to the water surface) was then lengthened to 120\angs, and the systems were further equilibrated for 10 ns. The simulations all employed periodic boundaries to create an ``infinite-slab'' geometry. After equilibrating the neat-\wat~slabs two types of systems were created by introducing \suldiox: a single-\suldiox~system, herein referred to as the ``neat-water'' system, and a ``saturated'' \suldiox~system with many gaseous surface and bulk-water \suldiox~molecules.

The low and high concentration simulated systems, ``neat-water'' and ``saturated water'', respectively, were created as follows: the neat-water simulation involved the addition of a single \suldiox~molecule either within the bulk of the water slab (for equilibrium MD), or above the slab surface (in the SMD simulations). The single-\suldiox~neat-water system was then evolved for 2 ns to produce an equilibrated starting configuration. Because of the extremely low concentration of \suldiox~in the neat-water system the surface waters behave similarly to a true neat-water air-liquid interface. The neat-water system orientational results shown later in this work reproduce well the results of our previous orientational studies of surface water behavior.\cite{Walker2006b,Hore2008} The saturated system had 22 \suldiox~molecules introduced to the water slab bulk in order to saturate it to a level coinciding with the Henry's law constant for \suldiox~in water. Additionally, 50 \suldiox~molecules were introduced into the gas phase outside of the saturated water slab to simulate an added \suldiox~gas pressure. The saturated system with both bulk and gaseous \suldiox~was then evolved for 2 ns to produce a starting configuration for further saturated simulations.

\subsection{Equilibrium Molecular Dynamics Simulations}

Equilibrium simulations involved adding \suldiox~to a water slab and equilibrating as outlined above. The neat-water system had a single \suldiox~added to the center of the water box, representing a concentration of 0.06 M. The more concentrated ``saturated'' system consisted of 22 \suldiox~molecules in the bulk corresponding to a concentration 1.35 M. This saturated system was exposed to an additional 50 \suldiox~in the gas phase above the water surface. After equilibration for 2 ns, both the low and high concentration systems were then evolved for a further 10 ns data collection using a time step of 0.5 fs, with atomic coordinates recorded every 100 fs.

\subsection{Steered Molecular Dynamics Simulations}

% need to add in the specifics about the SMD routine, force constants, calculations, etc.
A second set of simulations began with an equilibrated water slab as in the surface equilibrated method above. However, in both the neat-water and saturated starting systems, a single \suldiox~was introduced 20\angs~above the water slab surface, with the sulfur atom tethered to its initial position. The systems were then evolved for 1 ns, taking coordinate snapshots every 20 ps to create 50 starting points for further simulations. Steered molecular dynamics (SMD) were then performed on the 50 system configurations (in both the neat-water and saturated configurations) to guide the \suldiox~down towards a tethered water near the water slab's center of mass by applying a small steering force to the \suldiox-sulfur atom. This steering technique has been previously developed and used to successfully model chemical events.\cite{Isralewitz2001,Giorgino2011,Bizzarri2011,Strzelecki2009,Patargias2009,Liu2006} The \suldiox~thus passed through the continuum of environments from gas phase to (neat- and saturated) water surface adsorption, and finally absorption into the bulk of the \wat~slab. Each of the SMD simulations were performed for a total of 200 ps, using a time step of 1 fs, and taking snapshots of the system every 25 fs. Figure \ref{fig:starting-configurations} illustrates two sample starting configurations for the SMD simulations, showing both the neat-water slab and the saturated slab configurations before steering the \suldiox~towards the water bulk.

A separate set of SMD simulations were performed with tethering of one of the \suldiox-oxygens to the water slab center of mass. This was done to ensure that the orientation of the \suldiox~during the adsorption transit was not an artifact of the choice of atom used for tethering. The simulations produced the same results (not shown) for the orientational analyses, so the data from the original tethering scheme was used.

\begin{figure}[h!]
	\begin{center}
		\includegraphics[scale=1.0]{images/startingconfigurations.png}
		\caption{Sample starting configurations for the two types of SMD simulations. The neat-water slab simulation introduces a single \suldiox~molecule that is then guided into the surface of the water and further into the bulk (left). The saturated slab simulation begins with a water system that has been loaded with \suldiox~to saturate the water phase, and also with a high pressure of \suldiox~gas (right). The single \suldiox~(shown at the top) is then steered through the surface region saturated with \suldiox~molecules, and into the water bulk.}
		\label{fig:starting-configurations}
	\end{center}
\end{figure}

\subsection {Aqueous Surface Location}

	The first portion of the studies involved creating orientational depth-profiles in the interfacial region comprised of \suldiox~and \wat~upon exposure and adsorption of the gas. Recognizing that a liquid surface is a dynamic boundary that is neither flat nor stationary, we must define a reference point in the interfacial region which we refer to here as the water surface location. Several previous studies have used the technique of fitting a line shape to the averaged density profile of the water, and extracting interfacial shape and location parameters to define the water surface location.\cite{Shamay2010,Wick2006c,Chowdhary2006} Hyperbolic tangent functions have been used often, and values for the ``Gibb's dividing surface'' location, and interfacial width have thus been determined.\cite{Matsumoto1988} However, in long simulations the location and shape of the interface changes, and the motion of surface waters alters the interfacial width at any given time step. Thus, the density profile fitting will capture averaged widths and locations, not instantaneous values. Similarly, the averaged values of location and width will obscure information about any drift or deformations the surface undergoes. The analysis presented here attempts to retain these subtleties through the use of a ``corrected'' coordinate system.
	
Figure \ref{fig:density-flaw} demonstrates the problem of surface location drift during a simulation. Figure \ref{fig:density-flaw}A shows the density profile of water and \suldiox~over the course of one of the 10 ns trajectories used in this work using the original uncorrected coordinates of the system taken from the raw atomic positions of the molecular dynamics data output. The water density profile and location (thin gray line in Figure \ref{fig:density-flaw}A) is produced by averaging the instantaneous density profile at each time step in the simulation over all the time steps. The water profile was then fit to a $\tanh$ function (black line) to extract the position and width parameters of the water surface. The fitted Gibbs dividing surface has a width of 3.77\angs, which is comparable to values reported for similar neat-water systems.\cite{Dang1997,Hore2008} A bulge in the gas-phase ($\leq 52$\angs) side of the water density profile is indicative of the drift of the water slab over the course of the trajectory. Thus the calculated location and width from the $\tanh$ line fit are not accurate over long trajectories for defining a stationary reference point. 

	To overcome this problem we define the water surface location by calculating a reference location at each time step by averaging the positions of the waters contained in the topmost monolayer. This provides us with a consistent and intuitive reference point in the simulations to which we relate our analyses, but does not increase the computational burden. The number of waters included in the averaging is determined by taking a few issues into account. First, counting the waters found in the topmost cross-section of the water slab over several time steps indicated between 65-75 waters that established a full monolayer. This was done by a visual inspection of the slab using the VMD MD visualization package.\cite{HUMP96} Alternatively, assuming a spherical model of water with a radius of 2.2\angs~(the typical length of a bulk-water hydrogen bond), two layers of hexagonally tight-packed spheres yielded a similar number of surface water molecules. Increasing the number of waters used in calculating the surface location diminishes the effects of the few waters that briefly rise above the surface into the gas phase, stabilizing both the surface position and thickness values. Taking the close-packed model as a maximum number of waters fit into a flat surface, the topmost 70 water molecules were used for calculating instantaneous water surface locations for each simulation step. 
  
This method for finding the outer monolayer location was implemented, and the surface location is plotted as a function of simulation time in Figure \ref{fig:density-flaw}B. It is apparent from the surface location plot that the water slab location, and thus the surface location, drifts over the 10 ns, spanning approximately 12 $\AA$. However, the maximum standard deviation of the positions of the waters comprising the surface layer at each time step is only 1.85 $\AA$. Consequently, all depth locations in our analyses are calculated relative to the instantaneous surface location at the corresponding time step of the trajectories.

\begin{figure}[h!]
	\begin{center}
		\includegraphics[scale=1.0]{images/density/density-location.png}
		\caption{(A) Density profiles of \wat~(Gray) and \suldiox~(red) from a 10 ns simulation of the neat-water system with a single sulfur dioxide. The \wat~density profile was fit using a hyperbolic tangent function (black) to extract location and width data for the water surface. Position values are based on the atomic position data of the water oxygens and \suldiox~sulfurs from the raw molecular dynamics output. (B) The instantaneous location of the outer \wat~monolayer was calculated for each simulation time step (blue), and the surface location extracted from the density fitting was also shown for reference (horizontal dashed line). Long simulations of liquid slabs result in drift of the slab location, and the consequent broadening of the water density profile if the surface location is not determined repeatedly throughout the simulation.}
		\label{fig:density-flaw}
	\end{center}
\end{figure}


  %Taking one of the simulations of the neat-water slabs, a series of calculations were performed to find the averaged positions and the standard deviations of varying numbers of the topmost waters. It was found that using 70 waters produced a standard deviation of the water positions corresponding to a width of 3.2\angs. as reported by Baer et al.when fitting the density profile with a hyperbolic tangent lineshape. To match the interfacial width of Baer using the standard deviation of our simulations, 70 water molecules would have to be included in the top monolayer. Thus, the calculations and analyses presented in this work incorporate 70 water molecules when calculating the surface location.


\subsection{Molecular Orientation}

Knowing the molecular orientation of both the \wat~and \suldiox~is a prerequisite for understanding the chemistry occurring during the \suldiox~adsorption process. With the surface location as defined above, the simulated systems were analyzed to characterize the orientation of \wat~and \suldiox~in various environments above, within, and below the aqueous surface region. The two molecules studied are similarly shaped with a C2$_v$ axis along their bisectors, and a molecular plane defined by three atoms. A body-fixed frame is defined for both \wat~and \suldiox~as shown in Figure \ref{fig:molecular-frame}. In each analysis a space-fixed reference axis is used that corresponds to the long axis of the system's periodic cell normal to the plane of the water surface. The orientational analyses presented herein focus on two angles used to define molecular orientation. The molecular orientation angles $\theta$ and $\phi$ are determined from a set reference axis as shown in Figure \ref{fig:water-angles}A.
	
	The ``tilt'' angle, $\theta$, defines the angle formed between the molecular bisector vector (the molecular z-axis, pointing from the central atom in the direction of the other two atoms) and the positive system reference axis. Thus the value of $\theta$ falls within a range of $[0,\pi]$. An angle of $\cos(\theta)=1$ indicates a molecule with its bisector aligned with the reference axis, while $\cos(\theta)=-1$ results from an anti-aligned configuration. Sample representations of different values of $\cos(\theta)$ are shown in Figure \ref{fig:water-angles}B.
	
	A second angle, $\phi$, defines the molecular ``twist'' for certain configurations of the molecule. $\phi$ is the angle formed between the vector normal to the plane of the molecule (molecular y-axis) and the system reference axis. The values of $\phi$ fall in the interval $[0,\frac{\pi}{2}]$ because of the symmetry of \wat~and \suldiox~molecules with respect to twist about their bisector axes. For values of $\cos(\theta) \approx 0$, $\phi$ provides additional information about whether the molecular orientation is ``flat'' to the surface (e.g. the plane of the molecule is aligned with the plane of the surface), or if it is perpendicular. The values of $\cos(\phi)$ for different molecular orientations are shown in Figure \ref{fig:water-angles}C. %However, the symmetry of the \wat~and \suldiox~molecules create equivalence between the two H, or O, atoms (in the \wat~or\suldiox, respectively). $\phi=-\pi$ is equivalent to $\phi=\pi$, and both situations are equivalent to $\phi=0$. Because $\phi=-\phi$, the value is reported within the range of $[0,\frac \pi 2]$. 
	However, values of $\cos(\theta)$ close to 1 or -1 result in an isotropic distribution in $\cos(\phi)$ because of the symmetry of the plane of the surface in directions perpendicular to the reference axis.

%	The two molecules studied, \wat~and \suldiox, and similarly shaped with a C2$_v$ axis along their bisectors, and a molecular plane is defined by their three atoms. The orientational analyses presented herein focus on two angles used to define the molecular orientation in space. In each analysis a reference axis is used to define molecular angles, and is the z-axis unless otherwise specified. A ``tilt'' angle, $\theta$, defines the angle formed between a vector (generally the bisector vector pointing from the central atom in the direction of the other two atoms) and the positive reference axis. Thus the value of $\theta$ falls within a range of $[0,\pi]$. A second angle, $\phi$, defines the molecular ``twist'' around the reference axis. $\phi$ is formed between the projection of a vector onto the x-y reference plane, and the x-axis. $\phi$ is thus defined relative to the x-axis, and its values are in the interval $[-\pi,\pi]$. However, because of the symmetry of the \wat~and \suldiox~molecules and the equivalence of the two H or O atoms (in the \wat~or\suldiox, respectively), $\phi=-\pi$ is equivalent to $\phi=\pi$, and both situations are equivalent to $\phi=0$. Because $\phi=-\phi$, the value is reported within the range of $[0,\frac \pi 2]$. Figure \ref{fig:spherical-angle} shows the angle definitions using the z-axis as the reference axis.

\begin{figure}[h!]
	\begin{center}
		\includegraphics[scale=1.0]{images/angle-cartoons/molecularframesmall.png}
		\caption{Molecular body-fixed axes are defined with the x-z plane formed by the three atoms, and the z-axis aligned to the molecular bisector. The y-axis is normal to the molecular plane, and one of the bonds points in the positive x direction.}
		\label{fig:molecular-frame}
	\end{center}
\end{figure}

\begin{figure}[h!]
	\begin{center}
		\includegraphics[scale=1.0]{images/angle-cartoons/molecular-angles.png}
		\caption{(A) The definition of the angles $\theta$ and $\phi$ used to define molecular orientation of \suldiox~and \wat~relative to a reference axis. (B) $\theta$ is the value of the ``tilt'' of the molecular bisector from the reference axis, with $\cos(\theta)$ values ranging from -1 to +1 indicating different bisector orientations. (C) $\phi$ is the ``twist'' angle formed between the vector normal to the molecular plane (the body-fixed y-axis) and the reference axis. For values of $\cos(\theta) \approx 0$, $\phi$ shows how flat the molecule is relative to the interfacial plane.}
		\label{fig:water-angles}
	\end{center}
\end{figure}

%\subsection{Hydrate Complex Analysis}

%During the adsorption process of a gaseous \suldiox~moving in towards a water surface hydrate complexes are formed as the waters bind to the molecule. Computationally, there are various methods to determine hydrate complex formation. The most simple metric is to count the number of hydrogen bonds formed from the \suldiox~to neighboring molecules. This method can be furthered extended to also include the strength of those bonding interactions by additionally reporting the bondlengths to the hydrogen bonding partners. Longer bondlengths are typical of weaker bonds, and this method is used in this work to identify the bonding environment of the \suldiox~during solvation.

%A simple count of hydrogen bonds is telling of the interactions and environments of an adsorbing \suldiox. However, a more sophisticated analysis is needed to fully characterize the geometry of any complexes that form. In this work a graph theoretical method has been used to identify hydrate complexes that form cyclic structures in addition to those that form more simple hydrogen bonding geometries. Previously published works have detailed graph theory for use in molecular systems, and have used graph theoretical methods to describe ice and water clusters, structural energies, as well as in the study of relationships in biological systems.\cite{Huber2007,Shi2005,Radhakrishnan1991,Anick2002} As such, we will not present here a review of the basic graph theoretical details that are well documented in the referenced works. As shown in Figure \ref{fig:so2-complex-graph}, the atoms of a \suldiox~and its nearest neighbors are represented as a set of verrtices, with the covalent and hydrogen bonds between them forming the edges of a graph.

%We present here a technique for determining bonding cycles in a hydrate complex, but this technique is general enough to be applied to any graph representation of simple molecular systems. The first step in the determination of cycles is translating the atoms (vertices) and bonds (edges) to a graph. Figure \ref{fig:so2-complex-graph} shows the procedure visually, where here the root vertex of the graph is the \suldiox-sulfur, and each atom is numbered by the distance, in atoms, to the root vertex. We use only the closest neighboring water molecules that may take part in a cyclic complex in building the graph. After forming the graph, a breadth-first search (BFS) is performed starting at the root vertex.\cite{Knuth1997} The BFS algorithm uses a coloring technique where all unexamined vertices are colored white, queued vertices are gray, and examined vertices are black. During the BFS, encountering a gray vertex as a target of an adjacent edge during examination indicates that a cycle has been found in the graph. At each vertex dequeue for examination, the parent of every vertex is recorded such that the lineage from gray target to root vertex can be reconstructed to determine the participating atoms in the cycle.

%\begin{figure}[h!]
%\begin{center}
%\includegraphics[scale=1.0]{images/Cycles/so2complexfigure.png}
%\caption{A \suldiox~and its nearest neighbors are represented as a graph of vertices and edges. The bonds are all given equal weights and the graph is undirected. The numbering shows the relative distance from any atom to the root node (\suldiox-sulfur 1), and also enumerates the iteration through the BFS process at which the atom is discovered. A BFS on this graph would result in discovering the doubly-bound hydrogen (5) as a gray target, and the gray source would be either of the connected oxygens (4). At each iteration the predecessor in the BFS is recorded in order to reconstruct the connectivity of the cycle. This cycle is composed of 8 atoms, and 3 molecules}
%\label{fig:so2-complex-graph}
%\end{center}
%\end{figure}
